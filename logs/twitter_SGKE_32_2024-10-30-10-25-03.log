2024-10-30 10:25:03,089 - ============================== args ==============================
2024-10-30 10:25:03,089 - dataset: twitter
2024-10-30 10:25:03,089 - model: SGKE
2024-10-30 10:25:03,089 - batch: 32
2024-10-30 10:25:03,089 - seed: 666
2024-10-30 10:25:03,089 - ============================== End args ==============================
2024-10-30 10:25:03,089 - ============================== config ==============================
2024-10-30 10:25:03,090 - BertModel: <class 'transformers.models.bert.modeling_bert.BertModel'>
2024-10-30 10:25:03,090 - BertTokenizer: <class 'transformers.models.bert.tokenization_bert.BertTokenizer'>
2024-10-30 10:25:03,090 - att_dropout: 0
2024-10-30 10:25:03,090 - att_num_heads: 8
2024-10-30 10:25:03,090 - batch_size: 32
2024-10-30 10:25:03,090 - bert_dir: ./bert-base-multilingual-uncased/
2024-10-30 10:25:03,090 - bert_freeze: False
2024-10-30 10:25:03,090 - classifier_hidden_dim: 128
2024-10-30 10:25:03,090 - decayRate: 0.96
2024-10-30 10:25:03,090 - device: cuda
2024-10-30 10:25:03,090 - edge_feats: 768
2024-10-30 10:25:03,090 - epoch: 10
2024-10-30 10:25:03,090 - f_dropout: 0
2024-10-30 10:25:03,090 - hidden_dim: 768
2024-10-30 10:25:03,090 - img_dim: 768
2024-10-30 10:25:03,090 - knowledge_enhanced: True
2024-10-30 10:25:03,090 - lr: 5e-05
2024-10-30 10:25:03,090 - max_captions_num: 5
2024-10-30 10:25:03,090 - max_images_num: 5
2024-10-30 10:25:03,090 - model_saved_path: ./best_model/
2024-10-30 10:25:03,090 - n_layers: 2
2024-10-30 10:25:03,090 - node_feats: 768
2024-10-30 10:25:03,090 - num_classes: 3
2024-10-30 10:25:03,090 - num_heads: 2
2024-10-30 10:25:03,090 - out_feats: 768
2024-10-30 10:25:03,090 - patience: 3
2024-10-30 10:25:03,090 - resnet101_path: ./ResNet/resnet101-5d3b4d8f.pth
2024-10-30 10:25:03,090 - resnet50_path: ./ResNet/resnet50-11ad3fa6.pth
2024-10-30 10:25:03,090 - swin_transformer: ./swin-transformer
2024-10-30 10:25:03,090 - test_ratio: 0.1
2024-10-30 10:25:03,090 - text_dim: 768
2024-10-30 10:25:03,091 - text_max_length: 40
2024-10-30 10:25:03,091 - torch: <module 'torch' from '/home/huang001/anaconda3/lib/python3.11/site-packages/torch/__init__.py'>
2024-10-30 10:25:03,091 - train_ratio: 0.8
2024-10-30 10:25:03,091 - twitter_dataset_dir: ./data/Twitter/
2024-10-30 10:25:03,091 - val_ratio: 0.1
2024-10-30 10:25:03,091 - weibo_dataset_dir: ./data/Weibo/
2024-10-30 10:25:03,091 - ============================== End config ==============================
2024-10-30 10:25:08,901 - total number of parameters:240711671
2024-10-30 10:25:08,906 - -----------Epoch:0-----------
2024-10-30 10:46:57,797 - train_loss:0.45649 train_acc:0.769
2024-10-30 10:49:19,870 - val_loss:0.22852 val_acc:0.915 

2024-10-30 10:49:21,216 - save model,acc:0.915
2024-10-30 10:49:21,216 - -----------Epoch:1-----------
2024-10-30 11:11:07,375 - train_loss:0.16428 train_acc:0.930
2024-10-30 11:13:27,959 - val_loss:0.13239 val_acc:0.945 

2024-10-30 11:13:29,714 - save model,acc:0.945
2024-10-30 11:13:29,714 - -----------Epoch:2-----------
2024-10-30 11:35:17,661 - train_loss:0.06667 train_acc:0.974
2024-10-30 11:37:39,318 - val_loss:0.15495 val_acc:0.954 

2024-10-30 11:37:41,075 - save model,acc:0.954
2024-10-30 11:37:41,076 - -----------Epoch:3-----------
2024-10-30 11:59:29,952 - train_loss:0.03801 train_acc:0.985
2024-10-30 12:01:52,250 - val_loss:0.14253 val_acc:0.946 

2024-10-30 12:01:52,250 - -----------Epoch:4-----------
2024-10-30 12:23:39,507 - train_loss:0.03263 train_acc:0.987
2024-10-30 12:26:00,362 - val_loss:0.14597 val_acc:0.944 

2024-10-30 12:26:00,362 - -----------Epoch:5-----------
2024-10-30 12:47:49,714 - train_loss:0.01683 train_acc:0.994
2024-10-30 12:50:11,343 - val_loss:0.13970 val_acc:0.962 

2024-10-30 12:50:13,072 - save model,acc:0.962
2024-10-30 12:50:13,072 - -----------Epoch:6-----------
2024-10-30 13:12:00,842 - train_loss:0.00336 train_acc:0.999
2024-10-30 13:14:22,183 - val_loss:0.18423 val_acc:0.950 

2024-10-30 13:14:22,183 - -----------Epoch:7-----------
2024-10-30 13:36:03,763 - train_loss:0.01663 train_acc:0.993
2024-10-30 13:38:24,105 - val_loss:0.21997 val_acc:0.929 

2024-10-30 13:38:24,106 - -----------Epoch:8-----------
2024-10-30 14:00:00,772 - train_loss:0.01943 train_acc:0.993
2024-10-30 14:02:21,179 - val_loss:0.47927 val_acc:0.841 

2024-10-30 14:04:39,555 - --------------------- test results-------------------------------
2024-10-30 14:04:39,556 - acc:0.9443699  prec:[0.9698492  0.9122807  0.96644294]  rec:[1.         0.8666667  0.96644294]  f1:[0.9846939  0.8888889  0.96644294]
2024-10-30 14:04:39,556 - confusion: 
[[193   0   0]
 [  6 104  10]
 [  0  10 288]]
2024-10-30 14:04:39,617 - the running time is: 13170.7 s
