2024-10-29 12:00:26,527 - ============================== args ==============================
2024-10-29 12:00:26,527 - dataset: twitter
2024-10-29 12:00:26,527 - model: SGKE
2024-10-29 12:00:26,528 - batch: 32
2024-10-29 12:00:26,528 - seed: 666
2024-10-29 12:00:26,528 - ============================== End args ==============================
2024-10-29 12:00:26,528 - ============================== config ==============================
2024-10-29 12:00:26,528 - BertModel: <class 'transformers.models.bert.modeling_bert.BertModel'>
2024-10-29 12:00:26,528 - BertTokenizer: <class 'transformers.models.bert.tokenization_bert.BertTokenizer'>
2024-10-29 12:00:26,528 - att_dropout: 0
2024-10-29 12:00:26,528 - att_num_heads: 8
2024-10-29 12:00:26,528 - batch_size: 32
2024-10-29 12:00:26,528 - bert_dir: ./bert-base-multilingual-uncased/
2024-10-29 12:00:26,528 - bert_freeze: False
2024-10-29 12:00:26,528 - classifier_hidden_dim: 128
2024-10-29 12:00:26,528 - decayRate: 0.96
2024-10-29 12:00:26,528 - device: cuda
2024-10-29 12:00:26,528 - edge_feats: 768
2024-10-29 12:00:26,528 - epoch: 10
2024-10-29 12:00:26,528 - f_dropout: 0
2024-10-29 12:00:26,528 - hidden_dim: 768
2024-10-29 12:00:26,528 - img_dim: 768
2024-10-29 12:00:26,528 - knowledge_enhanced: True
2024-10-29 12:00:26,528 - lr: 5e-05
2024-10-29 12:00:26,528 - max_captions_num: 5
2024-10-29 12:00:26,528 - max_images_num: 5
2024-10-29 12:00:26,528 - model_saved_path: ./best_model/
2024-10-29 12:00:26,528 - n_layers: 2
2024-10-29 12:00:26,528 - node_feats: 768
2024-10-29 12:00:26,528 - num_classes: 3
2024-10-29 12:00:26,528 - num_heads: 2
2024-10-29 12:00:26,528 - out_feats: 768
2024-10-29 12:00:26,528 - patience: 3
2024-10-29 12:00:26,528 - resnet101_path: ./ResNet/resnet101-5d3b4d8f.pth
2024-10-29 12:00:26,529 - resnet50_path: ./ResNet/resnet50-11ad3fa6.pth
2024-10-29 12:00:26,529 - swin_transformer: ./swin-transformer
2024-10-29 12:00:26,529 - test_ratio: 0.1
2024-10-29 12:00:26,529 - text_dim: 768
2024-10-29 12:00:26,529 - text_max_length: 40
2024-10-29 12:00:26,529 - torch: <module 'torch' from '/home/huang001/anaconda3/lib/python3.11/site-packages/torch/__init__.py'>
2024-10-29 12:00:26,529 - train_ratio: 0.8
2024-10-29 12:00:26,529 - twitter_dataset_dir: ./data/Twitter/
2024-10-29 12:00:26,529 - val_ratio: 0.1
2024-10-29 12:00:26,529 - weibo_dataset_dir: ./data/Weibo/
2024-10-29 12:00:26,529 - ============================== End config ==============================
2024-10-29 12:00:32,352 - total number of parameters:240711671
2024-10-29 12:00:32,357 - -----------Epoch:0-----------
2024-10-29 12:22:32,745 - train_loss:0.44335 train_acc:0.777
2024-10-29 12:24:44,777 - val_loss:0.18046 val_acc:0.926 

2024-10-29 12:24:46,005 - save model,acc:0.926
2024-10-29 12:24:46,005 - -----------Epoch:1-----------
2024-10-29 12:46:39,398 - train_loss:0.13647 train_acc:0.940
2024-10-29 12:48:52,138 - val_loss:0.18660 val_acc:0.936 

2024-10-29 12:48:53,912 - save model,acc:0.936
2024-10-29 12:48:53,912 - -----------Epoch:2-----------
2024-10-29 13:10:52,037 - train_loss:0.06028 train_acc:0.976
2024-10-29 13:13:05,349 - val_loss:0.15213 val_acc:0.924 

2024-10-29 13:13:05,350 - -----------Epoch:3-----------
2024-10-29 13:35:08,164 - train_loss:0.04584 train_acc:0.979
2024-10-29 13:37:21,239 - val_loss:0.16133 val_acc:0.939 

2024-10-29 13:37:23,090 - save model,acc:0.939
2024-10-29 13:37:23,090 - -----------Epoch:4-----------
2024-10-29 13:59:24,401 - train_loss:0.02473 train_acc:0.989
2024-10-29 14:01:37,537 - val_loss:0.21659 val_acc:0.939 

2024-10-29 14:01:39,312 - save model,acc:0.939
2024-10-29 14:01:39,312 - -----------Epoch:5-----------
2024-10-29 14:23:44,463 - train_loss:0.01690 train_acc:0.994
2024-10-29 14:25:57,518 - val_loss:0.23839 val_acc:0.936 

2024-10-29 14:25:57,518 - -----------Epoch:6-----------
2024-10-29 14:48:01,505 - train_loss:0.00242 train_acc:1.000
2024-10-29 14:50:14,430 - val_loss:0.18852 val_acc:0.954 

2024-10-29 14:50:16,182 - save model,acc:0.954
2024-10-29 14:50:16,183 - -----------Epoch:7-----------
2024-10-29 15:12:23,126 - train_loss:0.00388 train_acc:0.999
2024-10-29 15:14:35,720 - val_loss:0.20820 val_acc:0.953 

2024-10-29 15:14:35,720 - -----------Epoch:8-----------
2024-10-29 15:36:39,106 - train_loss:0.00772 train_acc:0.998
2024-10-29 15:38:52,197 - val_loss:0.24052 val_acc:0.939 

2024-10-29 15:38:52,197 - -----------Epoch:9-----------
2024-10-29 16:00:59,654 - train_loss:0.01884 train_acc:0.990
2024-10-29 16:03:12,541 - val_loss:0.20031 val_acc:0.950 

2024-10-29 16:05:29,636 - --------------------- test results-------------------------------
2024-10-29 16:05:29,637 - acc:0.95741606  prec:[0.9744898  0.94736844 0.96099293]  rec:[0.9947917 0.9130435 0.9644128]  f1:[0.9845361  0.9298893  0.96269983]
2024-10-29 16:05:29,637 - confusion: 
[[191   0   1]
 [  2 126  10]
 [  3   7 271]]
2024-10-29 16:05:29,698 - the running time is: 14697.3 s
