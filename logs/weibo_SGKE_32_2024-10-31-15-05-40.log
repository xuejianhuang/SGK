2024-10-31 15:05:40,226 - ============================== args ==============================
2024-10-31 15:05:40,226 - dataset: weibo
2024-10-31 15:05:40,226 - model: SGKE
2024-10-31 15:05:40,226 - batch: 32
2024-10-31 15:05:40,226 - seed: 666
2024-10-31 15:05:40,226 - ============================== End args ==============================
2024-10-31 15:05:40,226 - ============================== config ==============================
2024-10-31 15:05:40,226 - BertModel: <class 'transformers.models.bert.modeling_bert.BertModel'>
2024-10-31 15:05:40,226 - BertTokenizer: <class 'transformers.models.bert.tokenization_bert.BertTokenizer'>
2024-10-31 15:05:40,226 - att_dropout: 0
2024-10-31 15:05:40,226 - att_num_heads: 8
2024-10-31 15:05:40,226 - batch_size: 32
2024-10-31 15:05:40,226 - bert_dir: ./bert-base-multilingual-uncased/
2024-10-31 15:05:40,226 - bert_freeze: False
2024-10-31 15:05:40,226 - classifier_hidden_dim: 128
2024-10-31 15:05:40,226 - decayRate: 0.96
2024-10-31 15:05:40,226 - device: cuda
2024-10-31 15:05:40,226 - edge_feats: 768
2024-10-31 15:05:40,226 - epoch: 10
2024-10-31 15:05:40,226 - f_dropout: 0
2024-10-31 15:05:40,226 - hidden_dim: 768
2024-10-31 15:05:40,226 - img_dim: 768
2024-10-31 15:05:40,226 - knowledge_enhanced: True
2024-10-31 15:05:40,226 - lr: 5e-05
2024-10-31 15:05:40,227 - max_captions_num: 5
2024-10-31 15:05:40,227 - max_images_num: 5
2024-10-31 15:05:40,227 - model_saved_path: ./best_model/
2024-10-31 15:05:40,227 - n_layers: 2
2024-10-31 15:05:40,227 - node_feats: 768
2024-10-31 15:05:40,227 - num_classes: 3
2024-10-31 15:05:40,227 - num_heads: 2
2024-10-31 15:05:40,227 - out_feats: 768
2024-10-31 15:05:40,227 - patience: 3
2024-10-31 15:05:40,227 - resnet101_path: ./ResNet/resnet101-5d3b4d8f.pth
2024-10-31 15:05:40,227 - resnet50_path: ./ResNet/resnet50-11ad3fa6.pth
2024-10-31 15:05:40,227 - swin_transformer: ./swin-transformer
2024-10-31 15:05:40,227 - test_ratio: 0.1
2024-10-31 15:05:40,227 - text_dim: 768
2024-10-31 15:05:40,227 - text_max_length: 40
2024-10-31 15:05:40,227 - torch: <module 'torch' from '/home/huang001/anaconda3/lib/python3.11/site-packages/torch/__init__.py'>
2024-10-31 15:05:40,227 - train_ratio: 0.8
2024-10-31 15:05:40,227 - twitter_dataset_dir: ./data/Twitter/
2024-10-31 15:05:40,227 - val_ratio: 0.1
2024-10-31 15:05:40,227 - weibo_dataset_dir: ./data/Weibo/
2024-10-31 15:05:40,227 - ============================== End config ==============================
2024-10-31 15:05:47,217 - total number of parameters:240711671
2024-10-31 15:05:47,221 - -----------Epoch:0-----------
2024-10-31 15:31:55,738 - train_loss:0.41223 train_acc:0.808
2024-10-31 15:34:46,247 - val_loss:0.30916 val_acc:0.870 

2024-10-31 15:34:47,497 - save model,acc:0.870
2024-10-31 15:34:47,497 - -----------Epoch:1-----------
2024-10-31 16:00:37,987 - train_loss:0.20699 train_acc:0.915
2024-10-31 16:03:27,121 - val_loss:0.27494 val_acc:0.904 

2024-10-31 16:03:28,871 - save model,acc:0.904
2024-10-31 16:03:28,872 - -----------Epoch:2-----------
2024-10-31 16:28:35,756 - train_loss:0.10668 train_acc:0.957
2024-10-31 16:31:25,288 - val_loss:0.23547 val_acc:0.912 

2024-10-31 16:31:27,076 - save model,acc:0.912
2024-10-31 16:31:27,076 - -----------Epoch:3-----------
2024-10-31 16:56:35,445 - train_loss:0.05372 train_acc:0.978
2024-10-31 16:59:25,230 - val_loss:0.24981 val_acc:0.915 

2024-10-31 16:59:27,009 - save model,acc:0.915
2024-10-31 16:59:27,010 - -----------Epoch:4-----------
2024-10-31 17:24:35,876 - train_loss:0.02915 train_acc:0.990
2024-10-31 17:27:24,895 - val_loss:0.35932 val_acc:0.881 

2024-10-31 17:27:24,896 - -----------Epoch:5-----------
2024-10-31 17:52:22,147 - train_loss:0.01917 train_acc:0.993
2024-10-31 17:55:10,469 - val_loss:0.34336 val_acc:0.894 

2024-10-31 17:55:10,469 - -----------Epoch:6-----------
2024-10-31 18:20:08,950 - train_loss:0.01416 train_acc:0.996
2024-10-31 18:22:58,211 - val_loss:0.32316 val_acc:0.916 

2024-10-31 18:23:00,019 - save model,acc:0.916
2024-10-31 18:23:00,019 - -----------Epoch:7-----------
2024-10-31 18:47:55,406 - train_loss:0.01038 train_acc:0.996
2024-10-31 18:50:43,660 - val_loss:0.39304 val_acc:0.919 

2024-10-31 18:50:45,490 - save model,acc:0.919
2024-10-31 18:50:45,490 - -----------Epoch:8-----------
2024-10-31 19:15:41,329 - train_loss:0.01040 train_acc:0.997
2024-10-31 19:18:29,337 - val_loss:0.37948 val_acc:0.902 

2024-10-31 19:18:29,337 - -----------Epoch:9-----------
2024-10-31 19:43:22,165 - train_loss:0.01721 train_acc:0.993
2024-10-31 19:46:09,521 - val_loss:0.38212 val_acc:0.908 

2024-10-31 19:48:47,012 - --------------------- test results-------------------------------
2024-10-31 19:48:47,012 - acc:0.9277173  prec:[0.96202534 0.8194444  0.9591195 ]  rec:[0.95      0.9465241 0.8866279]  f1:[0.9559748  0.8784119  0.92145014]
2024-10-31 19:48:47,013 - confusion: 
[[228   7   5]
 [  2 177   8]
 [  7  32 305]]
2024-10-31 19:48:47,076 - the running time is: 16979.9 s
