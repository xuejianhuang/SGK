2024-11-01 13:15:01,491 - ============================== args ==============================
2024-11-01 13:15:01,491 - dataset: weibo
2024-11-01 13:15:01,491 - model: SGKE
2024-11-01 13:15:01,491 - batch: 32
2024-11-01 13:15:01,491 - seed: 666
2024-11-01 13:15:01,491 - ============================== End args ==============================
2024-11-01 13:15:01,491 - ============================== config ==============================
2024-11-01 13:15:01,491 - BertModel: <class 'transformers.models.bert.modeling_bert.BertModel'>
2024-11-01 13:15:01,492 - BertTokenizer: <class 'transformers.models.bert.tokenization_bert.BertTokenizer'>
2024-11-01 13:15:01,492 - att_dropout: 0
2024-11-01 13:15:01,492 - att_num_heads: 8
2024-11-01 13:15:01,492 - batch_size: 32
2024-11-01 13:15:01,492 - bert_dir: ./bert-base-multilingual-uncased/
2024-11-01 13:15:01,492 - bert_freeze: False
2024-11-01 13:15:01,492 - classifier_hidden_dim: 128
2024-11-01 13:15:01,492 - decayRate: 0.96
2024-11-01 13:15:01,492 - device: cuda
2024-11-01 13:15:01,492 - edge_feats: 768
2024-11-01 13:15:01,492 - epoch: 10
2024-11-01 13:15:01,492 - f_dropout: 0
2024-11-01 13:15:01,492 - hidden_dim: 768
2024-11-01 13:15:01,492 - img_dim: 768
2024-11-01 13:15:01,492 - knowledge_enhanced: True
2024-11-01 13:15:01,492 - lr: 5e-05
2024-11-01 13:15:01,492 - max_captions_num: 5
2024-11-01 13:15:01,492 - max_images_num: 5
2024-11-01 13:15:01,492 - model_saved_path: ./best_model/
2024-11-01 13:15:01,492 - n_layers: 2
2024-11-01 13:15:01,492 - node_feats: 768
2024-11-01 13:15:01,492 - num_classes: 3
2024-11-01 13:15:01,492 - num_heads: 2
2024-11-01 13:15:01,492 - out_feats: 768
2024-11-01 13:15:01,492 - patience: 3
2024-11-01 13:15:01,492 - resnet101_path: ./ResNet/resnet101-5d3b4d8f.pth
2024-11-01 13:15:01,492 - resnet50_path: ./ResNet/resnet50-11ad3fa6.pth
2024-11-01 13:15:01,492 - swin_transformer: ./swin-transformer
2024-11-01 13:15:01,492 - test_ratio: 0.1
2024-11-01 13:15:01,492 - text_dim: 768
2024-11-01 13:15:01,492 - text_max_length: 40
2024-11-01 13:15:01,492 - torch: <module 'torch' from '/home/huang001/anaconda3/lib/python3.11/site-packages/torch/__init__.py'>
2024-11-01 13:15:01,492 - train_ratio: 0.8
2024-11-01 13:15:01,492 - twitter_dataset_dir: ./data/Twitter/
2024-11-01 13:15:01,493 - val_ratio: 0.1
2024-11-01 13:15:01,493 - weibo_dataset_dir: ./data/Weibo/
2024-11-01 13:15:01,493 - ============================== End config ==============================
2024-11-01 13:15:08,657 - total number of parameters:240711671
2024-11-01 13:15:08,661 - -----------Epoch:0-----------
2024-11-01 13:41:11,329 - train_loss:0.42355 train_acc:0.805
2024-11-01 13:43:47,474 - val_loss:0.22901 val_acc:0.913 

2024-11-01 13:43:48,765 - save model,acc:0.913
2024-11-01 13:43:48,766 - -----------Epoch:1-----------
2024-11-01 14:09:59,713 - train_loss:0.20325 train_acc:0.921
2024-11-01 14:12:36,468 - val_loss:0.17681 val_acc:0.933 

2024-11-01 14:12:38,096 - save model,acc:0.933
2024-11-01 14:12:38,096 - -----------Epoch:2-----------
2024-11-01 14:38:43,710 - train_loss:0.09746 train_acc:0.963
2024-11-01 14:41:18,993 - val_loss:0.23210 val_acc:0.917 

2024-11-01 14:41:18,994 - -----------Epoch:3-----------
2024-11-01 15:07:07,168 - train_loss:0.07242 train_acc:0.971
2024-11-01 15:09:41,684 - val_loss:0.18371 val_acc:0.924 

2024-11-01 15:09:41,685 - -----------Epoch:4-----------
2024-11-01 15:35:43,595 - train_loss:0.01836 train_acc:0.996
2024-11-01 15:38:18,315 - val_loss:0.20156 val_acc:0.934 

2024-11-01 15:38:20,014 - save model,acc:0.934
2024-11-01 15:38:20,015 - -----------Epoch:5-----------
2024-11-01 16:04:16,649 - train_loss:0.00855 train_acc:0.998
2024-11-01 16:06:51,250 - val_loss:0.24205 val_acc:0.925 

2024-11-01 16:06:51,251 - -----------Epoch:6-----------
2024-11-01 16:32:50,704 - train_loss:0.00366 train_acc:0.999
2024-11-01 16:35:24,334 - val_loss:0.24476 val_acc:0.935 

2024-11-01 16:35:26,082 - save model,acc:0.935
2024-11-01 16:35:26,082 - -----------Epoch:7-----------
2024-11-01 17:01:19,490 - train_loss:0.00440 train_acc:0.998
2024-11-01 17:03:53,241 - val_loss:0.31853 val_acc:0.927 

2024-11-01 17:03:53,242 - -----------Epoch:8-----------
2024-11-01 17:29:41,580 - train_loss:0.01982 train_acc:0.993
2024-11-01 17:32:14,549 - val_loss:0.29745 val_acc:0.924 

2024-11-01 17:32:14,549 - -----------Epoch:9-----------
2024-11-01 17:57:21,580 - train_loss:0.01881 train_acc:0.994
2024-11-01 17:59:53,356 - val_loss:0.30650 val_acc:0.927 

2024-11-01 18:02:30,700 - --------------------- test results-------------------------------
2024-11-01 18:02:30,701 - acc:0.936386  prec:[0.95564514 0.8764045  0.9536232 ]  rec:[0.97530866 0.9122807  0.92156863]  f1:[0.9653768  0.8939828  0.93732196]
2024-11-01 18:02:30,701 - confusion: 
[[237   2   4]
 [  3 156  12]
 [  8  20 329]]
2024-11-01 18:02:30,764 - the running time is: 17242.1 s
