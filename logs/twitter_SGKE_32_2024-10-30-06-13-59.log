2024-10-30 06:13:59,333 - ============================== args ==============================
2024-10-30 06:13:59,333 - dataset: twitter
2024-10-30 06:13:59,333 - model: SGKE
2024-10-30 06:13:59,333 - batch: 32
2024-10-30 06:13:59,333 - seed: 666
2024-10-30 06:13:59,333 - ============================== End args ==============================
2024-10-30 06:13:59,333 - ============================== config ==============================
2024-10-30 06:13:59,333 - BertModel: <class 'transformers.models.bert.modeling_bert.BertModel'>
2024-10-30 06:13:59,333 - BertTokenizer: <class 'transformers.models.bert.tokenization_bert.BertTokenizer'>
2024-10-30 06:13:59,333 - att_dropout: 0
2024-10-30 06:13:59,333 - att_num_heads: 8
2024-10-30 06:13:59,333 - batch_size: 32
2024-10-30 06:13:59,333 - bert_dir: ./bert-base-multilingual-uncased/
2024-10-30 06:13:59,334 - bert_freeze: False
2024-10-30 06:13:59,334 - classifier_hidden_dim: 128
2024-10-30 06:13:59,334 - decayRate: 0.96
2024-10-30 06:13:59,334 - device: cuda
2024-10-30 06:13:59,334 - edge_feats: 768
2024-10-30 06:13:59,334 - epoch: 10
2024-10-30 06:13:59,334 - f_dropout: 0
2024-10-30 06:13:59,334 - hidden_dim: 768
2024-10-30 06:13:59,334 - img_dim: 768
2024-10-30 06:13:59,334 - knowledge_enhanced: True
2024-10-30 06:13:59,334 - lr: 5e-05
2024-10-30 06:13:59,334 - max_captions_num: 5
2024-10-30 06:13:59,334 - max_images_num: 5
2024-10-30 06:13:59,334 - model_saved_path: ./best_model/
2024-10-30 06:13:59,334 - n_layers: 2
2024-10-30 06:13:59,334 - node_feats: 768
2024-10-30 06:13:59,334 - num_classes: 3
2024-10-30 06:13:59,334 - num_heads: 2
2024-10-30 06:13:59,334 - out_feats: 768
2024-10-30 06:13:59,334 - patience: 3
2024-10-30 06:13:59,334 - resnet101_path: ./ResNet/resnet101-5d3b4d8f.pth
2024-10-30 06:13:59,334 - resnet50_path: ./ResNet/resnet50-11ad3fa6.pth
2024-10-30 06:13:59,334 - swin_transformer: ./swin-transformer
2024-10-30 06:13:59,334 - test_ratio: 0.1
2024-10-30 06:13:59,334 - text_dim: 768
2024-10-30 06:13:59,334 - text_max_length: 40
2024-10-30 06:13:59,334 - torch: <module 'torch' from '/home/huang001/anaconda3/lib/python3.11/site-packages/torch/__init__.py'>
2024-10-30 06:13:59,334 - train_ratio: 0.8
2024-10-30 06:13:59,334 - twitter_dataset_dir: ./data/Twitter/
2024-10-30 06:13:59,334 - val_ratio: 0.1
2024-10-30 06:13:59,334 - weibo_dataset_dir: ./data/Weibo/
2024-10-30 06:13:59,334 - ============================== End config ==============================
2024-10-30 06:14:05,350 - total number of parameters:240711671
2024-10-30 06:14:05,355 - -----------Epoch:0-----------
2024-10-30 06:36:16,955 - train_loss:0.45166 train_acc:0.767
2024-10-30 06:38:38,524 - val_loss:0.36723 val_acc:0.777 

2024-10-30 06:38:39,841 - save model,acc:0.777
2024-10-30 06:38:39,841 - -----------Epoch:1-----------
2024-10-30 07:00:58,534 - train_loss:0.17025 train_acc:0.924
2024-10-30 07:03:20,830 - val_loss:0.25611 val_acc:0.887 

2024-10-30 07:03:22,599 - save model,acc:0.887
2024-10-30 07:03:22,600 - -----------Epoch:2-----------
2024-10-30 07:25:42,720 - train_loss:0.07000 train_acc:0.970
2024-10-30 07:28:04,116 - val_loss:0.18771 val_acc:0.909 

2024-10-30 07:28:05,956 - save model,acc:0.909
2024-10-30 07:28:05,957 - -----------Epoch:3-----------
2024-10-30 07:50:26,695 - train_loss:0.04135 train_acc:0.981
2024-10-30 07:52:48,161 - val_loss:0.31037 val_acc:0.908 

2024-10-30 07:52:48,162 - -----------Epoch:4-----------
2024-10-30 08:15:08,569 - train_loss:0.01921 train_acc:0.993
2024-10-30 08:17:29,876 - val_loss:0.19784 val_acc:0.939 

2024-10-30 08:17:31,726 - save model,acc:0.939
2024-10-30 08:17:31,727 - -----------Epoch:5-----------
2024-10-30 08:39:55,520 - train_loss:0.01512 train_acc:0.996
2024-10-30 08:42:17,337 - val_loss:0.20810 val_acc:0.937 

2024-10-30 08:42:17,338 - -----------Epoch:6-----------
2024-10-30 09:04:37,491 - train_loss:0.00212 train_acc:0.999
2024-10-30 09:06:56,956 - val_loss:0.31072 val_acc:0.930 

2024-10-30 09:06:56,956 - -----------Epoch:7-----------
2024-10-30 09:29:19,962 - train_loss:0.01210 train_acc:0.996
2024-10-30 09:31:42,347 - val_loss:0.23523 val_acc:0.942 

2024-10-30 09:31:44,201 - save model,acc:0.942
2024-10-30 09:31:44,202 - -----------Epoch:8-----------
2024-10-30 09:54:08,893 - train_loss:0.00840 train_acc:0.997
2024-10-30 09:56:30,530 - val_loss:0.26512 val_acc:0.932 

2024-10-30 09:56:30,530 - -----------Epoch:9-----------
2024-10-30 10:18:52,730 - train_loss:0.00318 train_acc:1.000
2024-10-30 10:21:14,555 - val_loss:0.25200 val_acc:0.939 

2024-10-30 10:23:40,020 - --------------------- test results-------------------------------
2024-10-30 10:23:40,021 - acc:0.95245934  prec:[0.97619045 0.85714287 0.9818182 ]  rec:[0.9855769 0.9310345 0.9407666]  f1:[0.98086125 0.892562   0.9608541 ]
2024-10-30 10:23:40,021 - confusion: 
[[205   2   1]
 [  4 108   4]
 [  1  16 270]]
2024-10-30 10:23:40,083 - the running time is: 14974.7 s
